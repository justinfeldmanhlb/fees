<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Timesheet v2 Demo</title>
<style>
  body { font-family: Arial, sans-serif; margin:0; padding:0; display:flex; height:100vh; }
  .corner { padding:10px; box-sizing:border-box; }
  #topLeft { width:25%; background:#f0f0f0; }
  #topRight { width:25%; background:#d0f0d0; display:flex; flex-direction:column; }
  #bottomLeft { width:25%; background:#f0d0d0; display:flex; flex-direction:column; align-items:center; justify-content:center; }
  #bottomRight { flex:1; background:#fff; border-left:1px solid #ccc; overflow:auto; padding:10px; }
  .task { background:#ffd966; padding:6px; margin:4px 0; border-radius:4px; cursor:grab; }
  .active { background:#66ccff !important; }
  .locked { opacity:0.5; cursor:default; }
  button { margin:4px 0; padding:6px; cursor:pointer; }
</style>
</head>
<body>

<!-- Top Left: Task Input & List -->
<div id="topLeft" class="corner">
  <h3>Tasks</h3>
  <input type="text" id="txtTask" placeholder="New Task + Enter">
  <button id="btnAddTask">Add Task</button>
  <div id="taskList"></div>
</div>

<!-- Top Right: Pre-fill & Lock/Post Fee -->
<div id="topRight" class="corner">
  <h3>Actions</h3>
  <button id="btnPreFill">Pre-Fill Teams Tasks</button>
  <button id="btnToggleLock">Lock/Unlock Tasks</button>
  <button id="btnPostFee">Post Fee</button>
</div>

<!-- Bottom Left: Quick Timer -->
<div id="bottomLeft" class="corner">
  <h3>Timer</h3>
  <div id="timerDisplay">00:00</div>
  <button id="btnStartStop">Start / Stop</button>
  <button id="btnReset">Reset</button>
</div>

<!-- Bottom Right: Active Tasks / Working Area -->
<div id="bottomRight" class="corner">
  <h3>Working Area</h3>
</div>

<script>
// --- Task Management ---
let tasks = [];
let activeTask = null;
let locked = false;
let timerRunning = false;
let seconds = 0;

// Add task
function addTask(desc) {
  const task = { id: Date.now(), desc, elapsed:0, locked:false };
  tasks.push(task);
  renderTasks();
}

// Render task list
function renderTasks() {
  const list = document.getElementById('taskList');
  list.innerHTML = '';
  tasks.forEach(t => {
    const div = document.createElement('div');
    div.className = 'task' + (t.locked ? ' locked' : '');
    div.textContent = t.desc + (t.elapsed ? ` (${Math.floor(t.elapsed/60)}m)` : '');
    div.draggable = !t.locked;
    div.dataset.id = t.id;
    div.addEventListener('dragstart', e=>{ activeTask = t; });
    list.appendChild(div);
  });
}

// Drag & Drop to working area
const workingArea = document.getElementById('bottomRight');
workingArea.addEventListener('dragover', e=>e.preventDefault());
workingArea.addEventListener('drop', e=>{
  if(activeTask && !activeTask.locked){
    const div = document.createElement('div');
    div.className = 'task active';
    div.textContent = activeTask.desc;
    workingArea.appendChild(div);
    activeTask.working = true;
    activeTask.elem = div;
  }
  activeTask = null;
});

// Input task
document.getElementById('btnAddTask').addEventListener('click', ()=> {
  const val = document.getElementById('txtTask').value.trim();
  if(val) { addTask(val); document.getElementById('txtTask').value=''; }
});
document.getElementById('txtTask').addEventListener('keypress', e=>{ if(e.key==='Enter'){ document.getElementById('btnAddTask').click(); } });

// Pre-fill Teams tasks (demo)
document.getElementById('btnPreFill').addEventListener('click', ()=>{
  ['Client Meeting – 30 min','Email to Client A – 15 min','Tax Review – 45 min'].forEach(addTask);
});

// Lock / Unlock tasks
document.getElementById('btnToggleLock').addEventListener('click', ()=>{
  locked = !locked;
  tasks.forEach(t=>t.locked = locked);
  renderTasks();
});

// Post Fee (just marks tasks as posted)
document.getElementById('btnPostFee').addEventListener('click', ()=>{
  tasks.forEach(t=>{
    if(t.working) t.locked=true;
  });
  renderTasks();
  alert('Fees posted for active tasks!');
});

// --- Timer ---
let timerInterval = null;
function updateTimerDisplay() {
  const min = String(Math.floor(seconds/60)).padStart(2,'0');
  const sec = String(seconds%60).padStart(2,'0');
  document.getElementById('timerDisplay').textContent = `${min}:${sec}`;
  // update active task elapsed
  tasks.filter(t=>t.working && !t.locked).forEach(t=>t.elapsed = seconds);
}
document.getElementById('btnStartStop').addEventListener('click', ()=>{
  if(timerRunning){ clearInterval(timerInterval); timerRunning=false; }
  else{ timerInterval = setInterval(()=>{ seconds++; updateTimerDisplay(); }, 1000); timerRunning=true; }
});
document.getElementById('btnReset').addEventListener('click', ()=>{
  clearInterval(timerInterval); timerRunning=false; seconds=0; updateTimerDisplay();
});

renderTasks();
</script>
</body>
</html>
