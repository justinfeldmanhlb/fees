<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Improved Timesheet</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    display: flex;
    height: 100vh;
    background: #eef3f7;
  }

  /* Left Panel */
  .left-panel {
    width: 260px;
    background: #ffffff;
    border-right: 1px solid #ccc;
    padding: 10px;
  }

  .task {
    background: #ffe58a;
    border: 1px solid #d4b200;
    padding: 8px;
    margin-bottom: 8px;
    border-radius: 4px;
    cursor: grab;
  }

  .task.dragging {
    opacity: 0.6;
    transform: scale(1.05);
  }

  /* Right Panel */
  .right-panel {
    flex: 1;
    overflow-y: scroll;
    padding: 20px;
    display: grid;
    grid-template-columns: 80px repeat(5, 1fr);
    gap: 4px;
  }

  .time-label {
    font-size: 12px;
    text-align: center;
    padding-top: 10px;
    color: #555;
  }

  .slot {
    background: #ffffff;
    border: 1px solid #bbb;
    height: 40px;
    position: relative;
  }

  .slot.over {
    outline: 2px dashed #007bff;
  }

  .task-block {
    position: absolute;
    top: 2px;
    left: 2px;
    right: 2px;
    bottom: 2px;
    background: #9ecbff;
    border: 1px solid #006dce;
    border-radius: 4px;
    padding: 4px;
    font-size: 11px;
    cursor: grab;
  }

  .task-block.dragging {
    opacity: 0.5;
  }

</style>
</head>
<body>

<!-- LEFT PANEL -->
<div class="left-panel">
  <h3>Tasks</h3>
  <div class="task" draggable="true">Emails – 20 min</div>
  <div class="task" draggable="true">Tax Work – 45 min</div>
  <div class="task" draggable="true">Client Call – 30 min</div>
</div>

<!-- RIGHT PANEL -->
<div class="right-panel" id="grid"></div>

<script>
/* ============================
   Generate Time Labels + Grid
   ============================ */
const grid = document.getElementById("grid");

// Time slots (8:00 → 17:00)
const startHour = 8;
const endHour = 17;

const days = ["Mon", "Tue", "Wed", "Thu", "Fri"];

// Header Row
grid.innerHTML += '<div></div>' + days.map(d => `<div class="time-label"><b>${d}</b></div>`).join("");

// Build rows
for (let hour = startHour; hour <= endHour; hour++) {
  const label = hour.toString().padStart(2, '0') + ":00";
  grid.innerHTML += `<div class="time-label">${label}</div>`;
  for (let d = 0; d < 5; d++) {
    grid.innerHTML += `<div class="slot" data-hour="${hour}" data-day="${d}"></div>`;
  }
}

/* ============================
   Drag Logic
   ============================ */
let dragged = null;

function makeDraggable(el) {
  el.addEventListener("dragstart", () => {
    dragged = el;
    el.classList.add("dragging");
  });
  el.addEventListener("dragend", () => {
    dragged = null;
    el.classList.remove("dragging");
  });
}

// Make initial tasks draggable
document.querySelectorAll(".task").forEach(makeDraggable);

// Apply dragover + drop behavior to slots
document.querySelectorAll(".slot").forEach(slot => {

  slot.addEventListener("dragover", e => {
    e.preventDefault();
    slot.classList.add("over");
  });

  slot.addEventListener("dragleave", () => {
    slot.classList.remove("over");
  });

  slot.addEventListener("drop", () => {
    slot.classList.remove("over");
    if (!dragged) return;

    // If dragging from the left panel
    if (dragged.classList.contains("task")) {
      const block = document.createElement("div");
      block.className = "task-block";
      block.textContent = dragged.textContent;
      block.setAttribute("draggable", "true");
      makeDraggable(block);
      slot.innerHTML = "";
      slot.appendChild(block);
    }

    // If dragging an existing block
    if (dragged.classList.contains("task-block")) {
      slot.innerHTML = "";
      slot.appendChild(dragged);
    }
  });
});
</script>

</body>
</html>
